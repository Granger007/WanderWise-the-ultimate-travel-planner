{% extends "base.html" %}
{% block title %}Error - WanderWise{% endblock %}

{% block content %}
<div class="row justify-content-center">
  <div class="col-md-8">
    <div class="card shadow-sm border-danger">
      <div class="card-header bg-danger text-white">
        <h4 class="mb-0">
          <i class="bi bi-exclamation-triangle"></i>
          {% if error_code %}Error {{ error_code }}{% else %}Error{% endif %}
        </h4>
      </div>

      <div class="card-body text-center py-5">
        <i class="bi bi-emoji-frown text-danger" style="font-size: 5rem;"></i>

        <h2 class="mt-4 mb-3">
          {% if error_code == 404 %}
            Page Not Found
          {% elif error_code == 500 %}
            Internal Server Error
          {% elif error_code == 403 %}
            Access Denied
          {% else %}
            Something Went Wrong
          {% endif %}
        </h2>

        <p class="lead text-muted">
          {% if error_message %}
            {{ error_message }}
          {% elif error_code == 404 %}
            The page you're looking for doesn't exist or has been moved.
          {% elif error_code == 500 %}
            We encountered an unexpected error. Our team has been notified.
          {% elif error_code == 403 %}
            You don't have permission to access this resource.
          {% else %}
            We're sorry, but something unexpected happened.
          {% endif %}
        </p>

        <!-- Common Error Scenarios -->
        {% if error_type %}
        <div class="alert alert-warning text-start mt-4" role="alert">
          <h6 class="alert-heading">
            <i class="bi bi-info-circle"></i> What might have caused this?
          </h6>
          <ul class="mb-0">
            {% if error_type == 'database' %}
              <li>Database connection issues</li>
              <li>Invalid data format or constraint violation</li>
              <li>Foreign key constraint failure</li>
              <li>Record not found in the database</li>
            {% elif error_type == 'validation' %}
              <li>Missing or invalid form data</li>
              <li>Invalid date range (end date before start date)</li>
              <li>Invalid ID or selection</li>
            {% elif error_type == 'booking' %}
              <li>Item already booked or unavailable</li>
              <li>Trip doesn't belong to selected user</li>
              <li>Pricing or seat information unavailable</li>
            {% else %}
              <li>Invalid URL or parameters</li>
              <li>Session timeout</li>
              <li>Network connectivity issue</li>
            {% endif %}
          </ul>
        </div>
        {% endif %}

        <!-- Suggested Actions -->
        <div class="card bg-light mt-4 text-start">
          <div class="card-body">
            <h6 class="card-title">
              <i class="bi bi-lightbulb"></i> What can you do?
            </h6>
            <ul class="mb-0">
              <li>Go back to the <a href="{{ url_for('user_home') }}">home page</a></li>
              <li>Try <a href="{{ url_for('search') }}">searching</a> for what you need</li>
              <li>Access the <a href="{{ url_for('admin_dashboard') }}">admin dashboard</a></li>
              <li>Check the <a href="{{ url_for('admin_dashboard') }}">data management panel</a> for missing entries</li>
              {% if error_code == 500 %}
                <li>Try again in a few moments</li>
                <li>Clear your browser cache and cookies</li>
              {% endif %}
            </ul>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="d-flex gap-2 justify-content-center mt-4">
          <button onclick="window.history.back()" class="btn btn-secondary">
            <i class="bi bi-arrow-left"></i> Go Back
          </button>
          <a href="{{ url_for('user_home') }}" class="btn btn-primary">
            <i class="bi bi-house"></i> Home Page
          </a>
          <a href="{{ url_for('search') }}" class="btn btn-success">
            <i class="bi bi-search"></i> Search
          </a>
        </div>
      </div>

      {% if error_details and config.DEBUG %}
      <div class="card-footer bg-light">
        <details>
          <summary class="text-danger" style="cursor: pointer;">
            <i class="bi bi-bug"></i> Technical Details (Debug Mode)
          </summary>
          <pre class="mt-3 mb-0 small text-start"><code>{{ error_details }}</code></pre>
        </details>
      </div>
      {% endif %}
    </div>
  </div>
</div>

<!-- Help Section -->
<div class="row justify-content-center mt-4">
  <div class="col-md-8">
    <div class="card bg-info text-white">
      <div class="card-body text-center">
        <h6 class="card-title">
          <i class="bi bi-question-circle"></i> Need Help?
        </h6>
        <p class="card-text small mb-0">
          If you continue to experience issues, please check the admin dashboard for data integrity
          or verify that all required records exist in the database.
        </p>
      </div>
    </div>
  </div>
</div>
{% endblock %}
